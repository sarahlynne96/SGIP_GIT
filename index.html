<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>California SGIP Eligibility & Rebate Estimator (v16)</title>
  <style>
    :root{--primary:#fdb813;--secondary:#003c71;--accent:#005eb8;--bg:#f9f9f9;--text:#333;--muted:#666}
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);line-height:1.45;padding-bottom:4rem}
    h1{font-size:2rem;font-weight:700;color:var(--primary);text-align:center;margin:1.4rem 0}
    .wrapper{max-width:960px;margin:0 auto;padding:0 1rem}
    fieldset{border:1px solid #ddd;border-radius:6px;padding:1rem;margin-bottom:1rem}
    legend{font-weight:600;color:var(--secondary);padding:0 .5rem}
    label{display:block;font-weight:600;color:var(--secondary);margin:.9rem 0 .4rem}
    select,input{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:1rem}
    small{display:block;margin-top:4px;color:var(--muted);font-size:.85rem}
    button{display:block;width:100%;background:var(--primary);color:#fff;border:none;padding:12px;font-size:1rem;border-radius:4px;font-weight:600;cursor:pointer;transition:background .3s;margin-top:1rem}
    button:hover{background:var(--accent)}button:disabled{opacity:.6;cursor:not-allowed}
    #incomeResult,#result{display:none;margin-top:22px;padding:18px;background:#fff;border-left:5px solid var(--primary);border-radius:4px;font-size:1rem}
    #result h3,#incomeResult h3{margin-top:0;color:var(--secondary)}
    .badge{display:inline-block;background:var(--secondary);color:#fff;padding:.25rem .55rem;border-radius:3px;font-size:.78rem;margin-right:6px}
    .track{margin-bottom:1rem}
    footer{font-size:.85rem;color:var(--muted);text-align:center;margin:3rem 0}
    ul{margin:0.5rem 0 0 1.2rem}
  </style>
</head>
<body>
  <h1>California SGIP Rebate Estimator</h1>
  <div class="wrapper">
    <p style="margin:0 0 1rem;font-size:.95rem;color:var(--muted)">Answer a few questions to see every SGIP track you may qualify for and a ball‑park rebate estimate.</p>

    <form id="calcForm" autocomplete="off" novalidate>
      <fieldset>
        <legend>1. Project details</legend>
        <label for="address">Installation address <em>(optional)</em></label>
        <input id="address" name="address" placeholder="1234 Main St, Fresno CA" />

        <label for="utility">Utility company</label>
        <select id="utility" name="utility" required>
          <option value="">Choose…</option>
          <option>CSE</option><option>SCE</option><option>SCG</option><option>PG&E</option><option>LADWP</option>
        </select>

        <label for="county">County <em>(for income test)</em></label>
        <select id="county" name="county" required>
          <option value="">Choose county…</option>
        </select>

        <label for="hhSize">Household size (persons)</label>
        <input id="hhSize" name="hhSize" type="number" min="1" max="8" step="1" value="4">

        <label for="hhIncome">Annual household income ($)</label>
        <input id="hhIncome" name="hhIncome" type="number" min="0" step="1000" placeholder="e.g. 95000">
        <small class="note">Low-income threshold = ≤ 80% AMI for selected county & household size.</small>
      </fieldset>

      <fieldset>
        <legend>2. Customer</legend>
        <label for="custType">Customer type</label>
        <select id="custType" name="custType" required>
          <option value="">Choose…</option>
          <option value="single">Home – Single-Family</option>
          <option value="multi">Home – Multifamily</option>
          <option value="nonres">Business / Non-Residential</option>
        </select>

        <label for="critFlag">Medical Baseline enrollee or critical well-pump?</label>
        <select id="critFlag" name="critFlag" required>
          <option value="">Choose…</option><option value="yes">Yes</option><option value="no">No</option>
        </select>
      </fieldset>

      <fieldset>
        <legend>3. Resiliency</legend>
        <label for="dacFlag">Site in DAC or HFTD?</label>
        <select id="dacFlag" name="dacFlag" required>
          <option value="">Choose…</option><option value="yes">Yes</option><option value="no">No / Unsure</option>
        </select>

        <label for="pspsFlag">≥ 2 PSPS shut‑offs since 2017?</label>
        <select id="pspsFlag" name="pspsFlag" required>
          <option value="">Choose…</option><option value="yes">Yes</option><option value="no">No / Unsure</option>
        </select>

        <label for="criticalFac">(Non‑Res) Critical facility?</label>
        <select id="criticalFac" name="criticalFac">
          <option value="">Choose…</option><option value="yes">Yes</option><option value="no">No</option>
        </select>

        <label for="sjvFlag">In San Joaquin Valley pilot city?</label>
        <select id="sjvFlag" name="sjvFlag" required>
          <option value="">Choose…</option><option value="yes">Yes</option><option value="no">No</option>
        </select>
      </fieldset>

      <fieldset>
        <legend>4. System size</legend>
        <label for="storageKWh">Battery usable capacity (kWh)</label>
        <input id="storageKWh" name="storageKWh" type="number" min="0" step="0.1" placeholder="e.g. 20" required>

        <label for="solarKW">Solar array size (kW) <em>(if pairing)</em></label>
        <input id="solarKW" name="solarKW" type="number" min="0" step="0.1" placeholder="e.g. 6">
      </fieldset>

      <button type="submit" id="btnCalc">Calculate & save</button>
    </form>

    <div id="incomeResult"></div>
        <div id="result"></div>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SGIP Residential Solar & Storage Equity Calculator</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin>
<script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin></script>
<style>
  :root{
    --primary:#fdb813;      /* orange bar                      */
    --secondary:#003c71;    /* CPUC navy                       */
    --accent:#005eb8;       /* link / focus accent             */
    --bg:#f5f5f5;
    --surface:#ffffff;
    --border:#e2e8f0;
    --text:#222;
    --muted:#555;
    --radius:8px;
    --shadow:0 2px 6px -2px rgba(0,0,0,.15);
    --fs-sm:.875rem;
    --fs-md:1rem;
    --fs-lg:1.25rem;
    --fs-xl:1.75rem;
  }
  *,*:before,*:after{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text)}
  a{color:var(--accent);text-decoration:none}
  a:hover{text-decoration:underline}

  /* ---------- HEADER ---------- */
  header{
    background:var(--primary);
    padding:1.5rem 1rem;
    box-shadow:var(--shadow);
  }
  header h1{
    margin:0 auto;
    max-width:1080px;
    font-size:var(--fs-xl);
    font-weight:700;
    color:#000;
    line-height:1.2;
    text-align:center;
  }

  /* ---------- LAYOUT ---------- */
  .container{
    max-width:1080px;
    margin:auto;
    padding:1.5rem 1rem 3rem;
    display:flex;
    flex-direction:column;
    gap:2rem;
  }
  .card{
    background:var(--surface);
    border:1px solid var(--border);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:1.25rem 1.5rem;
  }
  h2.section{
    margin:.25rem 0 1rem;
    font-size:var(--fs-lg);
    color:var(--secondary);
  }
  h3{margin:1rem 0 .75rem;font-size:var(--fs-md);color:var(--secondary)}
  label{display:block;margin-bottom:.4rem;font-weight:600;color:var(--secondary)}
  input,select{
    width:100%;padding:.65rem .75rem;font-size:var(--fs-md);
    border:1px solid var(--border);border-radius:6px;background:#fff;color:inherit;
  }
  input:focus,select:focus{border-color:var(--accent);outline:2px solid var(--accent);}
  .help{font-size:var(--fs-sm);color:var(--muted);margin-top:.35rem}
  .error{color:#c0392b;font-size:var(--fs-sm);margin-top:.35rem}

  .actions{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}
  button{
    border:none;border-radius:6px;cursor:pointer;min-height:42px;
    padding:.6rem 1rem;font-size:var(--fs-md);transition:filter .15s;
  }
  .primary{background:var(--primary);color:#000}
  .primary:hover{filter:brightness(1.05)}
  .secondary{background:#fff;border:1px solid var(--border)}
  .secondary:hover{background:#f1f5f9}

  table.budget{
    width:100%;border-collapse:collapse;margin:1rem 0 .75rem
  }
  table.budget th,table.budget td{
    border:1px solid var(--border);